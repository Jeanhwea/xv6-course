#+TITLE: 文件描述符层
#+AUTHOR: Jinghui Hu
#+EMAIL: hujinghui@buaa.edu.cn
#+DATE: <2023-12-08 Fri>
#+STARTUP: overview num indent
#+OPTIONS: ^:nil
#+PROPERTY: header-args:sh :results output :dir ../../study/os/xv6-public


* fd
1. file 数据结构
   - ref 结构体的引用计数
   - readable 读权限
   - writable 写权限
   - off 文件偏移
2. 全局文件表 ftable

* 文件操作
1. filealloc/filedup/fileclose
   - filealloc 分配一个 ref=0 的 file struct
   - filedup 增加 ref
   - fileclose 减少 ref, 释放资源
2. fileread 读取文件内容
3. filewrite 写入文件内容
